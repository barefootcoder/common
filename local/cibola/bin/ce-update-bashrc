#! /bin/bash

host=$1 ; shift
if [[ $host != *.* ]]
then
    host=$host.campusexplorer.com
fi
cessh="$CEROOT/devtools/cessh"
cescp="$CEROOT/devtools/cescp"

if ! $cessh $host cat .bashrc | grep -q "^alias go="
then
	cat <<'END' | $cessh $host cat ">>.bashrc"

export CEROOT=/var/local/CE
export CE_REMOTE_USERNAME=bburden
export PERL5LIB=$CEROOT/lib:$CEROOT/extlib/lib/perl5
alias go='sudo -H -u CE -i'
END
fi
if ! $cessh $host cat .bashrc | grep -q "^alias resrc="
then
	echo "alias resrc='source ~/.bashrc'" | $cessh $host cat ">>.bashrc"
fi
if ! $cessh $host cat .bashrc | grep -q "PATH=.*HOME/bin"
then
	echo '[[ $PATH == *$HOME/bin* ]] || export PATH=$PATH:$HOME/bin' | $cessh $host cat ">>.bashrc"
fi

$cescp -p ~/.exrc $host:

# set up for pjawk, but only on dirk
if [[ $host == dirk* ]]
then
	$cessh $host mkdir -p bin/
	$cescp $(find ~/common/ -name build-pjawk) $host:bin/
fi
